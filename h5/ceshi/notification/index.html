<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8"/>
    </head>
    <title>notification</title>
    <style>
        
        
    </style>
    <body>
        <button id="button">有人想加你为好友</button>
        <p id="text"></p>
        
        
        <script src="../js/jquery-1.8.3.min.js"></script>
        <script>
        //    var config={
        //        title:'我的通知栏',
        //        option:{
        //            //默认值是auto, 可以是ltr或rtl，有点类似direction属性。表示提示主体内容的水平书写顺序。
        //            dir:'auto',
        //            //提示的语言
        //            lang:'提示的语言',
        //            badge:'',
        //            //提示主体内容。字符串。会在标题的下面显示
        //            body:'今天通宵了',
        //            //字符串。标记当前通知的标签。
        //            tag:'我好困',
        //            //字符串。通知面板左侧那个图标地址
        //            icon:'../images/aliPayIcon.png',
        //            //任意类型和通知相关联的数据。
        //            data:'',
        //            //通知显示时候，设备震动硬件需要的振动模式。所谓振动模式，
        //             //指的是一个描述交替时间的数组，分别表示振动和不振动的毫秒数，
        //             //一直交替下去。例如[200, 100, 200]表示设备振动200毫秒，然后
        //             //停止100毫秒，再振动200毫秒。
        //            vibrate:[200, 100, 200],
        //            //布尔值。新通知出现的时候是否替换之前的。如果设为true，则表示替换，
        //            //表示当前标记的通知只会出现一个。
        //            renotify:false,
        //            //布尔值。通知出现的时候，是否要有声音。默认false, 表示无声。
        //            slient:false,
        //            //字符串。音频地址。表示通知出现要播放的声音资源。
        //            sound:'',
        //            //布尔值。是否不再屏幕上显示通知信息。默认false, 表示要在屏幕上显示通知内容
        //            noscreen:false,
        //            //布尔值。是否通知具有粘性，这样用户不太容易清除通知。默认false, 表示没有粘性
        //            sticky:false,
        //            requireInteraction:true,
        //            actions:''
        //        }
        //    }
        //    var options = {
        //        body: 'Do you like my body?',
        //        noscreen: true
        //    }
        // //    var notification=new Notification(config.title, options)
        // //    var permission = notification.permission;
        // Notification.requestPermission().then(function(result) {
        // // result可能是是granted, denied, 或default.
        //     console.log(result);
        //     console.log(Notification.prototype)

        //     new Notification(config.title, options)
        //     //无论是then中的还是直接callback函数的参数都是一样的，表示当前是否允许。只会是granted, denied, 或default.
        //     //其中granted表示用户允许通知，denied表示用户嫌弃你，default表示用户目前还没有管你。Notification.permission的值


        //     // 1. Notification.requestPermission()
        //     // 这是一个静态方法，作用就是让浏览器出现是否允许通知的提示
        //     // 2. Notification.permission[只读]
        //     // 这是一个静态属性。表示是否允许通知，值就是上面的granted, denied, 或default.

        //     // 默认情况下，Notification.permission的值是'default':
        //     // 默认用户是否允许通知的值

        //     // 因此，Notification.requestPermission()的回调方法中，可以不使用result参数，直接使用Notification.permission获取当前的通知状态。

        //     // 现在，用户允许出通知了，我们也知道可以出通知了，下面剩下的就是显示通知了。

        //     // 3. new Notification(title, options)
        //     // 通过new构造，显示通知。其中title是必须参数，表示通知小框框的标题内容，options是可选参数，对象，支持的参数以及释义见下表：
        //     // 4. Notification.close()
        //     // 通知显示了，如何关闭呢？可以通过调用Notification.close()实例方法，实际上，通知如果你放着不管，一段时间后就会自动隐藏，具体多久不详，我估摸着5秒有的。

        //     // 5. 事件句柄
        //     // Notification.onclick
        //     // 点击通知，然后……

        //     // Notification.onerror
        //     // 通知显示异常，然后。例如，明明Notification.permission是default，你还让我显示。

        //     // 下面这些呢有必要独立出来，虽然现在是支持挺好的，但是，由于目前规范并没有把它们列入其中，所以，未来有可能浏览器就不支持了。
        //     // Notification.onclose
        //     // 通知关闭了，然后…… 无论是用户手动关闭，还是直接Notification.close()关闭都会触发该该事件。

        //     // Notification.onshow
        //     // 通知显示的时候，该干嘛干嘛~~

        //     // 6. 其他属性值
        //     // 除了Notification.permission外，Notification还有很多其他只读属性值，但是，基本上和上面的options参数一致，返回的值也是options和默认值的合并值（如果浏览器支持的话）。

        //     // Notification.title[只读]

        //     // Notification.dir[只读]

        //     // Notification.lang[只读]

        //     // Notification.body[只读]

        //     // Notification.tag[只读]

        //     // Notification.icon[只读]

        //     // Notification.data[只读]

        //     // Notification.silent[只读]

        //     // Notification.title[只读]

        //     // Notification.timestamp[只读]
        //     // 通知创建或者可以使用的时间。

        //     // Notification.noscreen[只读]

        //     // Notification.renotify[只读]

        //     // Notification.sound[只读]

        //     // Notification.sticky[只读]

        //     // Notification.vibrate[只读]

        // });
        if (window.Notification) {
            var button = document.getElementById('button'), text = document.getElementById('text');
            
            var popNotice = function() {
                if (Notification.permission == "granted") {
                    var notification = new Notification("Hi，帅哥：", {
                        body: '可以加你为好友吗？',
                        icon: '../images/aliPayIcon.png'
                    });
                    
                    notification.onclick = function() {
                        text.innerHTML = '刘威已于' + new Date().toTimeString().split(' ')[0] + '加你为好友！';
                        notification.close();    
                    };
                }    
            };
            
            button.onclick = function() {
                if (Notification.permission == "granted") {
                    popNotice();
                } else if (Notification.permission != "denied") {
                    Notification.requestPermission(function (permission) {
                    popNotice();
                    });
                }
            };
        } else {
            alert('浏览器不支持Notification');    
        }
        </script>
    </body>
</html>